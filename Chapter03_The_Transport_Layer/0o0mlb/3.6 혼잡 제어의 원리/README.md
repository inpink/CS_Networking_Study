# 3.6 혼잡 제어의 원리
## 3.6.1 혼잡의 원인과 비용
호스트들이 자신의 전송률을 증가시키고 네트워크 혼잡이 발생함에 따라 무슨 일이 일어나는지에 대해 시나리오를 구분한다

### 시나리오 1: 2개의 송신자와 무한 버퍼를 갖는 하나의 라우터
오류 복구, 흐름 제어, 혼잡 제어를 수행하지 않고 라우터는 무제한의 버퍼 공간을 갖는다

- 이 시나리오는 처리량에서 R/2를 초과해서 패킷을 수신자에게 전달할 수 없다
R/2의 연결당 처리량을 얻는 것은 목적지에 패킷을 전달하는 데 링크를 최대로 활용하므로 좋은 현상이다

- 전송률이 R/2에 근접했을 때, 평균 지연은 점점 커지고 R/2을 초과할 때, 라우터 안에 큐잉된 패킷의 평균 개수는 제한되지 않고 출발지와 목적지 사이의 평균 지연이 무제한이 된다

따라서 처리량 관점에서는 이상적이지만, 지연 관점에서는 이상적이지 않다

즉, 패킷 도착률이 링크 용량에 근접함에 따라 큐잉 지연이 커진다는 혼잡 네트워크를 발견했다

### 시나리오2: 2개의 송신자, 유한 버퍼를 가진 하나의 라우터
라우터 버퍼의 양이 유한하고 각 연결이 신뢰적이다

트랜스포트 계층 세그먼트를 포함하는 패킷이 라우터에서 버려지면, 결국 송신자에 의해 재전송될 것이다

재전송이 어떻게 수행되는지에 따라 성능이 달라진다

1. 패킷이 확실히 손실된 것을 알았을 때만 송신자가 재전송하는 경우, 송신자는 버퍼 오버플로 때문에 버려진 패킷을 보상하기 위해 재전송을 수행해야 한다
2. 너무 일찍 타임아웃되어 패킷이 손실되지 않았지만 큐에서 지연되고 있는 패킷을 재전송하는 경우, 커다란 지연으로 인한 송신자의 불필요한 재전송은 라우터가 패킷의 불필요한 복사본을 전송하는 데 링크 대역폭을 사용한다

### 시나리오3: 4개의 송신자와 유한 버퍼를 갖는 라우터, 그리고 멀티홉 경로
각각의 호스트가 안정적인 데이터 전송 서비스를 실행하지 위해 타임아웃/재전송 메커니즘을 사용한다

트래픽이 많은 경우 종단 간 처리율이 0이 된다

혼잡 때문에 패킷을 경로상에서 버려질 때, 버려지는 지점까지 패킷을 전송하는 데 사용된 상위 라우터에서 사용된 전송 용량은 낭비된 것이다

---
## 3.6.2 혼잡 제어에 대한 접근법
네트워크 계층이 혼잡 제어를 목적으로 트랜스포트 계층에게 어떤 직접적인 도움을 제공하는지에 따라 혼잡 제어 접근을 구별할 수 있다

- 종단 간의 혼잡 제어: TCP 세그먼트 손실은 네트워크 혼잡의 발생 표시로 간주하고 TCP는 그에 따라서 **윈도 크기를 줄인다**
- 네트워크 지원 혼잡 제어: `ATM ABR` 혼잡 제어에서 라우터는 자신이 출력 링크에 제공할 수 있는 전송률을 송신자에게 명확히 알린다. 이는 네트워크에서 송신자에게 초크 패킷의 형태나 필드에 표시/수정함으로써 피드백된다
