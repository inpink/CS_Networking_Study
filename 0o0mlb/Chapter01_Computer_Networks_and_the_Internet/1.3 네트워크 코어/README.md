# 1.3 네트워크 코어
네트워크 코어란 인터넷의 종단 시스템을 연결하는 패킷 스위치와 링크의 그물망

## 1.3.1 패킷 교환
1. 출발지 종단 시스템에서 목적지 종단 시스템으로 `메시지`를 보내기 위해 송신 시스템은 긴 메시지를 `패킷(packet)`인 작은 데이터 덩어리로 분할한다
2. 각 패킷은 `통신 링크`와 `패킷 스위치(라우터, 링크 계층 스위치)`를 거치게 된다
3. 패킷은 **최대 전송률과 같은 속도**로 각각의 통신 링크에서 전송된다
4. 출발지 종단 시스템이나 패킷 스위치가 `R비트/초`의 속도로 링크에서 `L비트`의 패킷을 송신한다면 그 패킷을 전송하는테 걸리는 시간은 `L/R초`이다

### 저장-후-전달
대부분 패킷 스위치는 `저장-후-전달 전송 방식`을 이용한다

스위치가 출력 링크로 패킷의 첫 비트를 전송하기 전에 **전체 패킷**을 받아야 한다

출발지로부터 목적지 노드 까지 N개의 링크로 각각의 전송률이 R인 경로를 통해 하나의 패킷을 전송하는 경우, **종단 간 지연**은 `N*(L/R)`이다

### 큐잉 지연과 패킷 손실
각 패킷 스위치는 접속된 여러 개의 링크를 갖고, 패킷 스위치는 각 링크에 대해 `출력 버퍼(출력 큐)`를 갖고, **그 링크로 송신하려고 하는 패킷을 저장하고 있다**

도착한 패킷이 전송될 링크가 다른 패킷을 전송하고 있다면 **출력 버퍼에서 대기**해야 하는데, 이때 패킷은 `큐잉 지연(queuing delay)`을 겪는다

출력 버퍼가 꽉 차 있다면, `패킷 손실(packet loss)`가 발생한다

### 포워딩 테이블과 라우팅 프로토콜
라우터는 접속된 통신 링크 중 하나로 도착하는 패킷을 받아 **접속된 통신 링크 중 다른 링크로 그 패킷을 전달한다**

라우터는 어떻게 패킷을 어느 링크로 전달해야 하는지 결정하는가?
1. 패킷이 라우터에 도착한다
2. 라우터는 패킷의 IP 주소를 조사한다
3. 해당 목적지 주소를 이용하여 포워딩 테이블 검색한다
4. 패킷을 출력 링크로 전달한다

인터넷은 `라우팅 프로토콜(routing protocol)`을 통해 **각 라우터로부터 각 목적지까지의 최단 경로**를 결정하고 라우터에 `포워딩 테이블`을 설정한다

---
## 1.3.2 회선 교환
통신을 제공하기 위해 **경로상에 필요한 자원(버퍼, 링크 전송률)**은 통신 세션 동안에 `확보 또는 예약`된다

세션 메시지는 `on-demand 방식`으로 자원을 요청하여 사용하고, 통신 링크에 대한 접속을 위해 기다릴 수 있다 (큐에서 대기)

송신자는 수신자에게 보장된 일정 전송률로 데이터를 보낼 수 있다

두 호스트가 통신하고 싶을 때, 네트워크는 두 호스트 사이에 지정된 **종단 간 연결**을 설정한다

### 회선 교환 네트워크에서의 다중화
1. 주파수 분할 다중화 (frequency-division multiplexing, FDM)
2. 시분할 다중화 (time-division multiplexing, TDM)

### 주파수 분할 다중화 (FDM)
링크를 통해 설정된 연결은 그 링크의 주파수 스펙트럼을 공유한다

링크는 연결되는 동안, 각 연결에 대해 **주파수 대역을 고정 제공**한다 -> `대역폭 (bandwidth)`

### 시분할 다중화 (TDM)
시간을 일정 주기의 프레임으로 구분하고 각 프레임은 고정된 수의 `시간 슬롯`으로 나뉜다

네트워크가 링크를 통해 하나의 연결을 설정할 때, 네트워크는 모든 프레임에서 **시간 슬롯 1개를 그 연결에 할당한다**

회선의 전송률 : 한 슬롯 안의 비트수 x 프레임 전송률

### 패킷 교환 대 회선 교환
패킷 교환의 성능이 회선 교환보다 더 우수하다
- 회선 교환은 요구에 관계없이 미리 전송 링크 사용을 할당한다
- 패킷 교환은 요구할 때만 링크의 사용을 할당한다

---
## 1.3.3 네트워크의 네트워크
### 접속 ISP
> ISP(Internet Service Provider)이란 패킷 스위치와 통신 링크로 이루어진 네트워크이다

종단 시스템은 `접속 ISP`를 통해 인터넷에 연결된다

접속 ISP들이 **서로 연결되어야만 하기 때문에** `네트워크의 네트워크(network of network)`가 탄생한다

> 목표 : 모든 종단 시스템이 서로에게 패킷을 보낼 수 있도록 접속 ISP를 연결하는 것이다

### 네트워크 구조1
> 모든 접속 ISP를 **하나의 글로벌 통과(transit) ISP**와 연결한다
- 글로벌 통과 ISP는 라우터와 수십만 개의 접속 ISP와 가까운 곳에 있는 라우터를 갖는 통신 링크 네트워크이다
- 접속 ISP는 `고객`이고, 글로벌 ISP는 `제공자`이다

### 네트워크 구조2
> 수십만 개의 접속 ISP와 `다중의 글로벌 ISP`로 구성된다
- 상위층에 글로벌 통과 서비스 제공자가 있고 하위층에 접속 ISP가 있는 `2계층구조`의 형태
지역(regional) ISP : 1계층 ISP와 연결 = 글로벌 ISP

### 네트워크 구조3
> 다중계층구조로 접속 ISP -> 지역 ISP -> 1계층 ISP
- 각 ISP는 자신이 연결하는 상위 ISP에게 요금 지불
- 1계층 ISP는 계층구조의 최상위이기 때문에 요금 지불x

### 네트워크 구조4
> 다중계층구조(접속ISP, 지역ISP, 1계층ISP) + PoP + 멀티홈 + 피어링 + IXP

`PoP`: 제공자의 네트워크 내에 있는 하나 이상의 라우터 그룹

`멀티홈`: 둘 이상의 제공자 ISP에게 연결하는 것

`피어링`: 인터넷 계층구조의 같은 계층에 있는 라우터들이 피어링을 하여 요금 지불x

`IXP`: 다중 ISP들이 서로 피어링할 수 있는 만남의 장소

### 네트워크 구조5
> 네트워크 구조4 + 콘텐츠 제공자 네트워크
- 하위 계층 ISP들과 피어링을 함으로써 인터넷의 상위 계층을 우회
