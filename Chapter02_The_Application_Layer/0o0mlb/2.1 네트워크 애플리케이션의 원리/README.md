# 2.1 네트워크 애플리케이션의 원리
네트워크 애플리케이션 개발의 중심은 다른 위치의 종단 시스템에서 동작하고 네트워크를 통해 서로 통신하는 프로그램을 작성하는 것이다.

종단 시스템에만 애플리케이션 소프트웨어가 존재한다

## 2.1.1 네트워크 애플리케이션 구조
애플리케이션 개발자 관점에서 네트워크 구조는 고정되어있고, 해당 애플리케이션에 특정 서비스 집합을 제공함

반면, `애플리케이션 구조(application architecture)`는 애플리케이션 개발자가 설계하며, 애플리케이션이 다양한 종단 시스템에서 어떻게 조직되어야 하는지 알려줌

네트워크 애플리케이션에서 사용되는 두 가지 잘 알려진 구조가 있다.

### 클라이언트-서버 구조(client-server architecture)
- 항상 동작하고 있는 호스트를 `서버(server)`라고 부르고, 서버와의 서비스는 `클라이언트(client)`라는 다른 호스트들로부터 서비스 요청을 받는다
- 웹 서버가 클라이언트 호스트로부터 객체를 요청받으면 웹 서버는 요청된 객체를 클라이언트 호스트로 보내면서 응답
- 클라이언트는 서로 직접적으로 통신하지 않는다
- 서버가 고정 IP 주소를 갖는다
- 많은 수의 호스트를 갖춘 `데이터 센터(data center)`가 강력한 가상의 서버를 생성하는 역할로 사용된다

### P2P 구조
- 항상 켜져있는 인프라스트럭처 서버에 최소로 의존한다 (혹은 전혀 의존하지 않는다)
- 애플리케이션은 `피어(peer)`라는 간헐적으로 연결된 호스트 쌍이 서로 직접 통신한다
- 피어는 사용자들이 제어하는 데스크톱과 랩톱
- `자가 확장성(self-scalability)`
- 서버 인프라스트럭처와 서버 대역폭을 요구하지 않기 때문에 비용 효율적

---
## 2.1.2 프로세스 간 통신
> 프로세스란 종단 시스템에서 실행되는 프로그램이다.

2개의 종단 시스템에서 프로세스는 컴퓨터 네트워크를 통한 `메시지(message)` 교환으로 서로 통신한다

### 클라이언트와 서버 프로세스
네트워크 애플리케이션은 네트워크에서 서로 메시지를 보내는 두 프로세스로 구성된다
> 클라이언트: 두 프로세스 간의 통신 세션에서 통신을 초기화(다른 프로세스와 세션을 시작하려고 접속을 초기화)하는 프로세스

> 서버: 세션을 시작하기 위해 접속을 기다리는 프로세스

### 프로세스와 컴퓨터 네트워크 사이의 인터페이스
프로세스는 `소켓(socket)`을 통해 네트워크로 메시지를 보내고 받는다

**소켓(socket)**
- 호스트의 애플리케이션 계층과 트랜스포트 계층 간의 인터페이스
- 네트워크 애플리케이션이 인터넷에 만든 프로그래밍 인터페이스
- 애플리케이션과 네트워크 사이의 `API(Application Programming Interface)`

애플리케이션 개발자가 트랜스포트 프로토콜을 선택하면, 애플리케이션은 그 프로토콜이 제공하는 전송 서비스를 사용하여 구성된다

## 프로세스 주소 배정
프로세스가 패킷을 다른 프로세스로 보내기 위해서는, 수신 프로세스는 주소를 가져야 한다.

수신 프로세스를 식별하기 위해서는 두 가지 정보가 필요하다.
1. 호스트의 주소, `IP 주소`
2. 호스트 내의 수신 프로세스를 명시하는 식별자, `포트 번호(port number)`

---
## 2.1.3 애플리케이션이 이용 가능한 트랜스포트 서비스
애플리케이션을 개발할 때는 사용 가능한 트랜스포트 프로토콜 중에서 하나를 선택해야 한다.

트랜스포트 계층 프로토콜이 그것을 이용하는 애플리케이션들에게 제공할 수 있는 서비스는 신뢰적 데이터 전송/처리율/시간/보안 4가지가 있다

### 신뢰적 데이터 전송
프로토콜이 보장된 데이터 전송 서비스를 제공한다면 `신뢰적 데이터 전송(reliable data transfer)`

이는, 송신 프로세스는 데이터를 소켓으로 보내고 그 데이터가 오류 없이 수신 프로세스에 도착할 것이라는 확신을 갖는다

트랜스포트 계층 프로토콜이 신뢰적 데이터 전송을 제공하지 않을 때, 송신 프로세스가 보낸 데이터는 수신 프로세스에 전혀 도착하지 않을 수 있다.
이것은 `손실 허용 애플리케이션`의 경우, 어느 정도 데이터 손실을 참아낼 수 있는 멀티미디어 애플리케이션에서는 받아들여질 수 있다

### 처리율
네트워크 경로에 따라 두 프로세스 간의 통신 세션에서 송신 프로세스가 수신 프로세스로 비트를 전달할 수 있는 비율

가용된 처리율은 시간에 따라 변동하는데, 트랜스포트 프로토콜은 어느 정도 명시된 속도에서 보장된 가용 처리율을 제공한다

`대역폭 민감 애플리케이션(bandwidth-sensitive application)`: 특정 처리율 요구사항을 갖는 애플리케이션
'탄력적 애플리케이션(elastic application)`: 가용한 처리율을 많으면 많은 대로, 적으면 적은 대로 이용가능

### 시간
트랜스포트 계층 프로토콜은 시간 보장(timing guarantee)을 제공할 수 있다

실시간 상호작용 애플리케이션이 효과적으로 동작하기 위해서는 데이터 전송에 엄격한 시간 제한 조건이 요구된다

### 보안
트랜스포트 프로토콜은 애플리케이션에 하나 이상의 보안 서비스를 제공할 수 있다

기밀성(confidentiality), 데이터 무결성(integrity), 종단 인증(authentication)

---
## 2.1.4 인터넷 전송 프로토콜이 제공하는 서비스
인터넷은 애플리케이션에게 2개의 전송 프로토콜, 즉 UDP와 TCP를 제공한다.

즉, 애플리케이션 개발자는 새로운 인터넷 애플리케이션을 만들 때 가장 먼저 UDP와 TCP 중 어느 것을 사용할 것인지 결정해야 한다

### TCP 서비스
TCP 서비스 모델은 연결지향형 서비스와 신뢰적인 데이터 전송 서비스를 포함한다

- `연결지향형 서비스`: 애플리케이션 계층 메시지를 전송하기 전에 TCP는 클라이언트와 서버가 서로 전송 제어 정보를 교환하게 한다.
1. handshaking 과정이 클라이언트와 서버에 패킷이 곧 도달할 테니 준비하라고 알려주는 역할이다. 
2. 그 후, TCP 연결이 두 프로세스의 소켓 사이에 존재한다. 두 프로세스가 서로에게 동시에 메시지를 보낼 수 있기 때문에 전이중(full-duplex)연결이라 함

애플리케이션이 메시지 전송을 마치면 연결을 끊어야 한다

- `신뢰적인 데이터 전송 서비스`: 통신 프로세스는 모든 데이터를 오류 없이 오랍른 순서로 전달하기 위해 TCP에 의존한다.
TCP는 애플리케이션의 한쪽이 바이트 스트림을 소켓으로 전달하면 그 바이트 스트림이 손실되거나 중복되지 않게 수신 소켓으로 전달한다.

- '혼잡 제어 방식`: 통신하는 프로세스의 직접 이득보다는 인터넷의 전체 성능 향상을 위한 서비스를 포함한다.
네트워크가 혼잡 상태에 이르면 프로세스(클라이언트 또는 서버) 속도를 낮춘다

### UDP 서비스
UDP는 최소의 서비스 모델을 가진 간단한 전송 프로토콜이다.

- 비연결형 서비스, handshaking X
- 비신뢰적인 데이터 전송 서비스
- 혼잡 제어 방식 X : 데이터를 원하는 속도로 하위 계층(네트워크 계층)으로 보낼 수 있다

### 인터넷 트랜스포트 프로토콜이 제공하지 않는 서비스
오늘날의 인터넷은 때로 시간 민감 애플리케이션들에게 만족스런 서비스를 제공할 수 있으나, 시간 혹은 대역폭 보장을 제공할 수는 없다

전자메일, 원격 터미널 접속, 웹, 파일 전송 모두 TCP를 사용하여 모든 데이터가 궁극적으로 목적지에 도착하도록 보장하는 신뢰적 데이터 전송 서비스를 제공한다.

인터넷 전화 애플리케이션은 보통 패킷 손실을 허용하지만 효율성을 위해 최소의 전송률을 보장하는 UDP를 사용하여 TCP의 혼잡 제어 방식과 패킷 오버헤드(overhead)를 회피할 수 있다.
그러나, 많은 방화벽은 UDP 트래픽을 차단하도록 설정되어 있기 때문에, UDP 통신이 실패할 경우를 대비하여 TCP를 사용하도록 설계되어 있다.

---
## 2.1.5 애플리케이션 계층 프로토콜
`애플리케이션 계층 프로토콜(application-layer protocol)`은 다른 종단 시스템에서 실행되는 애플리케이션의 프로세스가 서로 메시지를 보내는 방법을 정의한다
- 교환 메시지 타입
- 여러 메시지 타입의 문법
- 필드의 의미, 즉 필드에 있는 정보의 의미
- 언제, 어떻게 프로세스가 메시지를 전송하고 메시지에 응답하는지 결정하는 규칙

여러 애플리케이션의 계층 프로토콜은 RFC에 명시되어 있으므로 공중 도메인(public domain)에서 찾을 수 있다. ex) HTTP

다른 많은 애플리케이션 계층 프로토콜은 독점이며 공중 도메인에서 구할 수 없다. ex) 스카이프

애플리케이션 계층 프로토콜은 네트워크 애플리케이션의 한 요소일 뿐이다.

웹 애플리케이션은 문서 포맷 표준, 웹 브라우저, 웹 서버, 애플리케이션 계층 프로토콜을 포함하는 여러 요소들로 구성된다.

웹 애플리케이션 계층 프로토콜, HTTP는 브라우저와 웹 서버 사이에서 교환되는 메시지의 포맷과 순서로 정의한다.
즉, 단지 웹 애플리케이션의 한 요소다.

---
## 2.1.6 이 책에서 다루는 네트워크 애플리케이션
웹 / 전자메일 / 디렉터리 서비스 / 비디오 스트리밍 / P2P 애플리케이션, 5개의 주요 애플리케이션 분야에 대해 자세히 다룬다.
