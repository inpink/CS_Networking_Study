# 4.1 네트워크 계층 개요
각 라우터의 데이터 평면 역할은 입력 링크에서 출력 링크로 데이터그램을 전달하는 것이다

네트워크 제어 평면의 역할은 데이터그램이 출발지 호스트에서 목적지 호스트까지 잘 전달되게끔 로컬 포워딩, 라우터별 포워딩을 대응시키는 것이다

라우터는 트랜스포트 계층, 애플리케이션 계층을 지원하지 않으므로 네트워크 상위 계층은 존재하지 않는다

## 4.1.1 포워딩과 라우팅: 데이터 평면과 제어 평면
네트워크 계층의 중요한 기능은 다음과 같다

1. `포워딩(전달)` : 패킷이 라우터의 입력 링크에 도달했을 때 라우터는 그 패킷을 적절한 출력 링크로 이동시켜야 한다. **데이터 평면**에서 실행된다. 매우 짧은 시간 단위를 갖기에, 대표적으로 하드웨어에서 실행된다
2. `라우팅` : 송신자가 수신자에게 패킷을 전송할 때 네트워크 계층은 패킷 경로를 결정해야 하는데 이러한 경로를 계산하는 알고리즘을 **라우팅 알고리즘**이라 한다. **제어 평면**에서 실행 된다. 데이터그램의 종단 간 경로를 결정하므로 더 긴 시간 단위를 갖기에 소프트웨어에서 보통 실행된다

네트워크 라우터에서 필수적인 요소는 `포워딩 테이블`이다. 라우터는 도착하는 **패킷 헤더의 필드값**을 조사하여 패킷을 전달하는 데 이 값을 라우터의 **포워딩 테이블의 내부 색인**으로 사용한다. 헤더의 값은 **패킷의 목적지 주소**이거나 **패킷이 속한 연결의 지시**일 수 있다

### 제어 평면: 전통적인 접근 방법
라우팅 알고리즘은 라우터의 포워딩 테이블의 내용을 결정한다

한 라우터의 라우팅 알고리즘 기능은 다른 라우터의 라우팅 알고리즘과 소통하며 포워딩 테이블의 값을 계산한다. 라우팅 프로토콜에 따라 라우팅 정보에 포함된 라우팅 메시지를 교환하며 계산이 이루어진다

### 제어 평먼: SDN 접근 방법
원격 컨트롤러가 높은 신뢰성과 중복성을 갖춘 원격 데이터 센터에 설치될 수 있으며, ISP 혹은 다른 제3자에 의해 관리될 수 있다

라우터와 원격 컨트롤러는 포워딩 테이블과 그 밖의 라우팅 정보를 포함한 메시지를 교환함으로써 소통할 수 있다.

제어 평면적 접근 방법은 **SDN(Software Defined Networking)** 의 중심으로 네트워크가 `소프트웨어적으로 정의되었을 때`, 포워딩 테이블을 계산하는 컨트롤러는 라우터와 상호작용을 하며 소프트웨어에서 실행된다

---
## 4.1.2 네트워크 서비스 모델
**네트워크 서비스 모델**은 송수신 호스트 간 패킷 전송 특성을 정의한다

- 보장된 전달: 패킷이 출발지 호스트에서 목적지 호스트까지 도착하는 것을 보장한다
- 지연 제한 이내의 보장된 전달: 호스트 간의 특정 지연 제한 안에 전달한다
- 순서화 패킷 전달: 패킷이 목적지에 송신된 순서대로 도착하는 것을 보장한다
- 최소 대역폭 보장: 특정한 비트율의 전송 링크를 에뮬레이트하여 비트들을 특정한 비트율 이하로 전송하는 한, 모든 패킷이 목적지 호스트까지 전달된다
- 보안 서비스: 모든 데이터그램을 출발지 호스트에서는 암호화, 목적지 호스트에서는 해독

인터넷 네트워크 계층은 **최선형 서비스(best-effort service)**을 제공한다

최선형 서비스는 패킷을 보내는 순서대로 수신됨을 보장할 수 없고, 목적지까지 전송 자체도 보장할 수 없다

- 링크 계층 스위치라고 불리는 패킷 스위치는 링크 계층 프레임의 필드값에 근거하여 포워딩을 결정한다. 스위치는 링크 계층(2계층) 장치라고 한다
- 라우터라고 불리는 패킷 스위치는 네트워크 계층 필드값에 근거하여 포워딩을 결정한다. 라우터는 네트워크 계층(3계층) 장치라고 한다
