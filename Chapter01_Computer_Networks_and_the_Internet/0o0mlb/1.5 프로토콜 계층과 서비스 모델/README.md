# 1.5 프로토콜 계층과 서비스 모델

## 1.5.1 계층구조
시스템이 계층구조를 가질 때, 그 계층이 제공하는 서비스의 구현을 변경하는 것도 매우 쉽다

### 프로토콜 계층화
한 계층이 상위 계층에 제공하는 서비스에 관심을 갖고, 이것을 계층의 **서비스 모델**이라한다

다양한 계층의 프로토콜을 모두 합하여 `프로토콜 스택(protocol stack)`이라 한다

인터넷 프로토콜 스택은 5개 계층으로 `물리` `링크` `네트워크` `트랜스포트` `애플리케이션` 계층

### 애플리케이션 계층
> 네트워크 애플리케이션과 애플리케이션 계층 프로토콜이 있는 곳이다
- HTTP, SMTP, FTP 같은 많은 프로토콜 포함한다
- `도메인 네임 서버(DNS)`: 32비트 네트워크 주소로 변환한다
- 한 종단 시스템에 있는 애플리케이션이 다른 종단 시스템에 있는 애플리케이션과 `정보 패킷(메시지)`을 교환하는데 이 프로토콜 사용한다

### 트랜스포트 계층
> 클라이언트와 서버 간에 애플리케이션 계층 메시지를 전송하는 서비스 제공한다
- `TCP`: 애플리케이션에게 연결 지향형 서비스 제공한다
- `UDP`: 애플리케이션에게 비연결형 서비스 제공한다
- 트랜스포트 계층 패킷은 `세그먼트(segment)`이다

### 네트워크 계층
> 한 호스트에서 다른 호스트로 `데이터그램(datagram)`을 라우팅하는 책임을 진다
- **목적지 호스트의 트랜스포트 계층으로 세그먼트를 운반**하는 서비스 제공한다
- `IP 프로토콜`: IP 데이터그램의 필드를 정의하며 종단 시스템과 라우터의 동작 정의한다
- `라우터 프로토콜`: 출발지와 목적지 사이에서 데이터그램이 이동하는 경로 결정한다

### 링크 계층
> 전체 프레임을 한 네트워크 요소에서 이웃 네트워크 요소로 이동시킨다
- 네트워크 계층이 보낸 데이터그램을 경로상의 다음 노드로 전달하고 다음 노드에서 그 데이터그램을 상위 네트워크 계층으로 보낸다
- 서비스는 그 링크에서 채용된 특정 링크 계층 프로토콜에 의해 결정된다
- 링크 계층 패킷은 `프레임(frame)`

### 물리 계층
> 프레임 내부의 각 비트를 한 노드에서 다음 노드로 이동시킨다
- 링크의 실제 전송 매체에 의존한다

---
## 1.5.2 캡슐화
- 트랜스포트 계층 세그먼트 = 애플리케이션 계층 메시지 + 트랜스포트 계층 헤더 정보
- 네트워크 계층 데이터그램 = 트랜스포트 계층 세그먼트 + 네트워크 계층 헤더 정보
- 링크 계층 프레임 = 네트워크 계층 데이터그램 + 링크 헤더 필드
- 수신 측에서 각 세그먼트는 분할된 데이터그램들도 재구성되어야 함
