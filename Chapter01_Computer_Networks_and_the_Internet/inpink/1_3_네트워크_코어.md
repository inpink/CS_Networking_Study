> 목차

👉[1.3 네트워크 코어](#13-네트워크-코어)　   
　   　   [1.3.1 패킷 교환](#131-패킷-교환)　   　   
　   　   [1.3.2 회선 교환](#132-회선-교환)　   
　   　   [1.3.3 네트워크의 네트워크](#133-네트워크의-네트워크)    
　   
　   
　    
## 1.3 네트워크 코어

20p 그림 1.10을 참고하자.　   
굵은 선(패킷 스위치, 그물망(mesh))은 **네트워크 코어**를 나타낸다.　   
　   
**링크, 스위치/라우터** 를 이용하여 네트워크에서 데이터를 이동시키는 방법에는 크게 2가지 방법이 있다.　   
1. 회선 교환(circuit switching)　   
2. 패킷 교환(packet switching)　   
　   
　   
### 1.3.1 패킷 교환

케이블 TV 등이 패킷을 전달하는 방식은 이 방식을 이용한 것이다.　   
　   
데이터는 **패킷**이라는 작은 데이터 덩어리로 쪼개지고, 각 패킷에는 헤더 정보가 추가적으로 담겨서 전송된다. 　   
패킷을 전송하는 데 걸리는 시간은 　   
~~~
L비트(패킷)           
/                =   L/R(초)
R비트/초              
~~~
이다.　   
　   
　   
　   
> 저장 후 전달 전송(store and forward transmission)

대부분은 이 방식을 이용한다.　   
스위치가 **모든 패킷**을 받아야만, 목적지로 패킷을 전송하기 시작한다. 　   
전달해야 할 패킷이 3개라면, 3개가 모두 스위치/라우터의 **큐**에 전달 되어야만 한다.　   
　   
N개의 링크(선), N-1개의 라우터가 있을 때, 　   
출발지에서 목적지로 **하나의 패킷**을 보내는 데 걸리는 시간은　   
~~~
N * L / R (초)
~~~
이다. 　   
　   
패킷(P)이 여러개일 때는 　   
~~~
(N+P-1)*(L/R)
~~~
이다.　   
　   
　   
　   
> 큐잉 지연 & 패킷 손실

스위치/라우터에는 **출력 버퍼(output buffer) 또는 출력 큐(queue)** 가 있다. 　   
이 곳에서 패킷들이 전송되기 전 잠시 저장된다. (저장-후-전달 지연)　   
버퍼, 큐의 크기는 유한하다.　   
네트워크 현재 혼잡 상황에 따라, 만약 버퍼/큐가 꽉 차있는데 새로운 패킷이 도착한다면, **패킷 손실(packet loss)** 이 일어난다. 　   
도착하는 패킷 또는 버퍼/큐에 있는 패킷을 삭제해버리는 것이다. 　   
이럴 경우, 출발지에 삭제된 데이터를 재요청하는 과정이 필요하다.　   
　   
　   
> 포워딩 테이블 & 라우팅 프로토콜

모든 종단 시스템은 고유의 **IP 주소** 를 갖는다.　   
출발지에서 목적지로 패킷이 도착하기 위해서 수많은 라우터를 거친다.　   
라우터는,  패킷에 있는 목적지 IP 주소를 참고해서  **라우팅 프로토콜**을 통해 다음으로 어떤 이웃 라우터에 패킷을 전달할지 결정한다.　   
**포워딩 테이블(forwarding table)** 에는 목적지에 도달하기 위해 어떤 라우터로 보내야 하는지 정보가 매핑되어 있다.　   
　   
　   
***
　   
　   
### 1.3.2 회선 교환

전화망을 이용하는 방식이 회선 교환 방식에 해당된다.　   
필요한 시간만큼 전화망을 **확보/예악**하여 독점한다.　   
일정한 **주파수 대역(대역폭)** 을 독점하는 것이다.　   
따라서, 통신 기간 동안 일정한 전송률이 보장된다. 　   
　   
25p 그림 1.13은 두 개의 스위치 사이 각 링크에 회선이 4개가 있다.　   
회선이 4개이므로, 4명의 호스트가 통신이 가능하다. 　   
하나의 링크에서 전송률이 1Mbsp이고, 4회선이 모두 사용중이라면, 각 회선의 전송 용량은 250kbps가 된다. 　   
　   
　   
> 다중화(multiplexing)

전화망은 전화, 다운스트림, 업스트림 3가지 용도로 사용된다고 했다.　   
위와 같이 하나의 회선을 여러 용도로 사용하여 여러 데이터를 **함께 전송** 할 수 있는 기술이 **다중화**이다. 　   
　   
1. 주파수 분할 다중화(frequency-division multiplexing, FDM)　   
2. 시분할 다중화(time-division multiplexing, TDM)　   
두 가지 방법이 있다.　   
　   
　   
> 주파수 분할 다중화

각자 다른 대역폭(bandwidth), 주파수 스펙트럼을 사용한다. 　   
　   
　   
> 시분할 다중화

여러 **프레임** 을 만들고, 프레임에는 정해진 개수의 **슬롯** 을 만든다.　   
같은 슬롯 번호를 같은 전송지가 쓰게 된다. 그러면 자연스럽게 시간에 따라 나눠서 한 회선을 이용하는 효과를 가지게 된다.　   
　   
링크가 초당 8000프레임을 전송하고, 각 슬롯이 8비트라면, **한 사용자 기준 전송률**은 8000 * 8= 64kbps 이다.　   
사용자는 1초에 8000프레임을 사용하고, 그 프레임 안에 1개의 슬롯(8비트)를 사용하기 때문이다.　   
　   
　   
　   
> 패킷 교환 vs 회선 교환

패킷 교환 단점 : 불규칙적이고 예측 불가능한 **큐잉 지연**　   
회선 교환 단점 : 회선 독점으로 인해, 데이터가 전송되지 않는 시간에 낭비 발생　   
　   
패킷 교환 장점 : 구현이 덜 복잡하고, 구현 비용이 더 적다. 　   
낭비되는 시간이 없으므로 전체적으로 봤을 때 오히려 전송 용량이 더 많다. 　   
이론적으로, 대부분의 경우에서 동시에 여러 사용자가 데이터를 전송할 확률은 매우 낮다. (27p 예시 참고)　   
따라서, 패킷 교환은 회선 교환보다 3배 이상의 사용자 수를 허용한다.　   
　   
　   
### 1.3.3 네트워크의 네트워크

31p 그림 1.15를 참고하자.　   

가정, 회사, 학교에서의 LAN만으로는 네트워크를 원활하게 이용할 수 없다.　   
온전한 네트워크를 위해선, 네트워크가 서로 망처럼 연결된 **네트워크의 네트워크**가 필요하다.　   
이를 위해 **ISP들끼리 연결**하는 것이 필요하다.　   
　   
모든 ISP들이 전세계의 모든 ISP와 개별적으로 연결해야 한다면? 비용이 어마어마하고 비효율적이다.　   
따라서, **계층 구조**를 이용한다.　   
가장 큰 단위의 1계층 ISP는 대도시 단위에 전세계적으로 12개정도 설립되어있다.　   
더 낮은 계층으로 갈수록, 더 지역적이다. 　   
같은 계층의 ISP들끼리는, 피어링(peering)을 하여 서로 요금을 내지 않고 데이터를 공유한다　   
　   
하위 계층에서 바로 1계층 ISP로 접속할 수도 있고, 지역 ISP를 거쳐서 접속할 수도 있다.　   
상위 계층의 ISP를 거친다면 사용하는 데이터 트래픽 양에 따른 비용을 지불해야 한다. 　   
　   
　   
> 콘텐츠 제공자

최근에는 **콘텐츠 제공자**가 자신들의 거대한 **네트워크**를 구축해서, ISP처럼 역할을 한다.　   
대표적인 예로는 **구글**이 있다.　   
구글은 전세계 19개정도의 데이터 센터를 설립하고, 구글에 오는 데이터는 최대한 이 데이터센터를 이용한다.　   
물론, 데이터센터만으로는 모든 데이터를 송수신할 수 없기에 ISP는 거쳐야할 일이 있다. 이 때는 ISP에 비용을 지불한다.　   
